@model IEnumerable<E_Learning_Platform.Models.ViewModel.AdminDashboard>

@{
    ViewBag.Title = "Dashboard";
}

<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <!-- Bootstrap 5 CSS -->
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link href="~/Content/dashboard.css" rel="stylesheet" />
    <!-- responsive adjustments -->
    @*<link href="~/Content/Responsive_Adjustments.css" rel="stylesheet" />*@
</head>
<body>
    <div class="layout-wrapper">
        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar ebg text-white" aria-hidden="false" aria-label="Main Sidebar">
            <div class="sidebar-header d-flex align-items-center justify-content-between px-3 py-2">
                <h5 class="mb-0 sidebar-title">E-Learning</h5>
                <!-- Floating toggle is used instead of an inline menu button -->
            </div>
            <ul class="list-unstyled px-2 mt-2">
                <li class="py-2">
                    <p class="mb-0 d-flex align-items-center gap-2 text-white">
                        <i class="bi bi-speedometer2"></i>
                        @Ajax.ActionLink(
                            "Dashboard",
                            "Admindashboard",
                            "Admin",
                            new AjaxOptions
                                 {
                                HttpMethod = "GET",
                                InsertionMode = InsertionMode.Replace,
                                UpdateTargetId = "target"
                            },
                            new { @class = "text-white text-decoration-none nav-text" }
                        )
                    </p>
                </li>
                <li class="py-2">
                    <p class="mb-0 d-flex align-items-center gap-2 text-white">
                        <i class="bi bi-speedometer2"></i>
                        @Ajax.ActionLink(
                            "Students",
                            "Students",
                            "Admin",
                            new AjaxOptions
                                 {
                                HttpMethod = "GET",
                                InsertionMode = InsertionMode.Replace,
                                UpdateTargetId = "target"
                            },
                            new { @class = "text-white text-decoration-none nav-text" }
                        )
                    </p>
                </li>

                <li class="py-2">
                    <p class="mb-0 d-flex align-items-center gap-2 text-white">
                        <i class="bi bi-journal-bookmark"></i>
                        @Ajax.ActionLink(
                            "Manage Students",
                            "ManageStudent",
                            "Admin",
                            new AjaxOptions
                                 {
                                HttpMethod = "GET",
                                InsertionMode = InsertionMode.Replace,
                                UpdateTargetId = "target"
                            },
                            new { @class = "text-white text-decoration-none nav-text" }
                        )
                    </p>
                </li>

                <li class="py-2">
                    <p class="mb-0 d-flex align-items-center gap-2 text-white">
                        <i class="bi bi-journal-check"></i>
                        @Ajax.ActionLink(
                            "Payments & Finance",
                            "Payments+Finance",
                            "Student",
                            new AjaxOptions
                                 {
                                HttpMethod = "GET",
                                InsertionMode = InsertionMode.Replace,
                                UpdateTargetId = "target"
                            },
                            new { @class = "text-white text-decoration-none nav-text" }
                        )
                    </p>
                </li>
                <li class="py-2">
                    <p class="mb-0 d-flex align-items-center gap-2 text-white">
                        <i class="bi bi-graph-up"></i>
                        @Ajax.ActionLink(
                            "Manage Subjects",
                            "ManageSubject",
                            "Admin",
                            new AjaxOptions
                                 {
                                HttpMethod = "GET",
                                InsertionMode = InsertionMode.Replace,
                                UpdateTargetId = "target"
                            },
                            new { @class = "text-white text-decoration-none nav-text" }
                        )
                    </p>
                </li>

                <li class="py-2">
                    <p class="mb-0 d-flex align-items-center gap-2 text-white">
                        <i class="bi bi-broadcast-pin"></i>
                        @Ajax.ActionLink(
                            "Manage Batches",
                            "Batches",
                            "Admin",
                            new AjaxOptions
                                 {
                                HttpMethod = "GET",
                                InsertionMode = InsertionMode.Replace,
                                UpdateTargetId = "target"
                            },
                            new { @class = "text-white text-decoration-none nav-text" }
                        )
                    </p>
                </li>
                <li class="py-2">
                    <p class="mb-0 d-flex align-items-center gap-2 text-white">
                        <i class="bi bi-folder"></i>
                        @Ajax.ActionLink(
                            "AppliedTeacher",
                            "AppliedTeacher",
                            "Admin",
                            new AjaxOptions
                                 {
                                HttpMethod = "GET",
                                InsertionMode = InsertionMode.Replace,
                                UpdateTargetId = "target"
                            },
                            new { @class = "text-white text-decoration-none nav-text" }
                        )
                    </p>
                </li>
                <li class="py-2">
                    <p class="mb-0 d-flex align-items-center gap-2 text-white">
                        <i class="bi bi-award"></i>
                        @Ajax.ActionLink(
                            "Course Reviews & Ratings",
                            "CourseReview",
                            "Admin",
                            new AjaxOptions
                                 {
                                HttpMethod = "GET",
                                InsertionMode = InsertionMode.Replace,
                                UpdateTargetId = "target"
                            },
                            new { @class = "text-white text-decoration-none nav-text" }
                        )
                    </p>
                </li>
                <li class="py-2">
                    <p class="mb-0 d-flex align-items-center gap-2 text-white">
                        <i class="bi bi-gear"></i>
                        @Ajax.ActionLink(
                            "Settings",
                            "Settings",
                            "Student",
                            new AjaxOptions
                                 {
                                HttpMethod = "GET",
                                InsertionMode = InsertionMode.Replace,
                                UpdateTargetId = "target"
                            },
                            new { @class = "text-white text-decoration-none nav-text" }
                        )
                    </p>
                </li>


            </ul>


        </aside>
        <!-- Floating Desktop/Mobile Toggle (visible on all screens) -->
        <button id="sidebarFloatToggle" class="sidebar-toggle-btn" aria-label="Toggle sidebar">
            <i id="sidebarFloatIcon" class="bi bi-chevron-double-left"></i>
        </button>
        <!-- Backdrop -->
        <div id="sidebarBackdrop" class="backdrop" hidden></div>
        <!-- Main Content -->
        <main class="content-area">
            <div class="container-fluid">
                <div id="target">
                    <div class="container-fluid p-4">
                        <!-- Page Title -->
                        <h3 class="fw-bold mb-4">Admin Dashboard</h3>
                        <!-- Top Stats Row -->
                        <div class="row g-3">

                            <!-- Total Students -->
                            <div class="col-md-3">
                                <div class="card shadow-sm border-0 p-3">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h6 class="text-muted mb-1">Total Students</h6>
                                            <h3 class="fw-bold">989</h3>
                                        </div>
                                        <i class="bi bi-people-fill fs-1 text-primary"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Total Teachers -->
                            <div class="col-md-3">
                                <div class="card shadow-sm border-0 p-3">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h6 class="text-muted mb-1">Total Teachers</h6>
                                            <h3 class="fw-bold">78</h3>
                                        </div>
                                        <i class="bi bi-person-badge-fill fs-1 text-success"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Total Courses -->
                            <div class="col-md-3">
                                <div class="card shadow-sm border-0 p-3">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h6 class="text-muted mb-1">Courses</h6>
                                            <h3 class="fw-bold">112</h3>
                                        </div>
                                        <i class="bi bi-journal-bookmark-fill fs-1 text-warning"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Revenue -->
                            <div class="col-md-3">
                                <div class="card shadow-sm border-0 p-3">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h6 class="text-muted mb-1">Monthly Revenue</h6>
                                            <h3 class="fw-bold">₹2,40,000</h3>
                                        </div>
                                        <i class="bi bi-cash-stack fs-1 text-danger"></i>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <!-- Charts + Recent Data -->
                        <div class="row g-3 mt-4">

                            <!-- Chart Placeholder -->
                            <div class="col-lg-8">
                                <div class="card shadow-sm border-0 p-3">
                                    <h5 class="fw-bold mb-2">User Enrollment Analytics</h5>
                                    <div class="text-center text-muted" style="height:250px; border:2px dashed #ccc;">
                                        Chart Placeholder
                                    </div>
                                </div>
                            </div>

                            <!-- Recent Users -->
                            <div class="col-lg-4">
                                <div class="card shadow-sm border-0 p-3">
                                    <h5 class="fw-bold mb-2">Recent Users</h5>
                                    <ul class="list-group list-group-flush">

                                        <li class="list-group-item px-0 d-flex justify-content-between">
                                            <span>Rohan Kumar</span>
                                            <span class="badge bg-success">Student</span>
                                        </li>

                                        <li class="list-group-item px-0 d-flex justify-content-between">
                                            <span>Anjali Verma</span>
                                            <span class="badge bg-primary">Teacher</span>
                                        </li>

                                        <li class="list-group-item px-0 d-flex justify-content-between">
                                            <span>Aditya Singh</span>
                                            <span class="badge bg-success">Student</span>
                                        </li>

                                    </ul>
                                </div>
                            </div>

                        </div>

                        <!-- Recent Courses -->
                        <div class="row g-3 mt-4">
                            <div class="col-12">
                                <div class="card shadow-sm border-0 p-3">
                                    <h5 class="fw-bold mb-3">Recent Courses</h5>

                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Course Name</th>
                                                <th>Instructor</th>
                                                <th>Category</th>
                                                <th>Enrolled</th>
                                                <th>Status</th>
                                            </tr>
                                        </thead>

                                        <tbody>
                                            <tr>
                                                <td>Full Stack Development</td>
                                                <td>Rajesh Sharma</td>
                                                <td>Programming</td>
                                                <td>340</td>
                                                <td><span class="badge bg-success">Active</span></td>
                                            </tr>

                                            <tr>
                                                <td>Digital Marketing Basics</td>
                                                <td>Neha Gupta</td>
                                                <td>Marketing</td>
                                                <td>198</td>
                                                <td><span class="badge bg-warning">Pending</span></td>
                                            </tr>

                                            <tr>
                                                <td>Data Science Mastery</td>
                                                <td>Dr. Mehul Patel</td>
                                                <td>Data Science</td>
                                                <td>430</td>
                                                <td><span class="badge bg-success">Active</span></td>
                                            </tr>

                                        </tbody>
                                    </table>

                                </div>
                            </div>
                        </div>

                    </div>

                </div>
            </div>
        </main>

    </div>

    <script>
        // Sidebar controls: desktop and mobile (menu button removed)
        const sidebar = document.getElementById("sidebar");
        const floatToggle = document.getElementById("sidebarFloatToggle");
        const floatIcon = document.getElementById("sidebarFloatIcon");
        const backdrop = document.getElementById("sidebarBackdrop");

        function isMobileView() {
            return window.innerWidth < 992;
        }

        // Position the floating toggle so it hugs the sidebar edge
        function positionFloatToggle() {
            if (!floatToggle) return;
            const rect = sidebar.getBoundingClientRect();
            const headerHeight = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--header-height')) || 65;
            const top = rect.top + headerHeight / 2;
            // place button near the right edge of the sidebar (works both for full and collapsed widths)
            const left = rect.left + rect.width - (floatToggle.offsetWidth / 2);
            floatToggle.style.top = Math.max(8, top) + 'px';
            floatToggle.style.left = Math.max(8, left) + 'px';
        }

        // Desktop & mobile mini toggle handler
        if (floatToggle) {
            floatToggle.addEventListener("click", () => {
                const wasCollapsed = sidebar.classList.toggle("collapsed");
                floatToggle.classList.toggle("collapsed", wasCollapsed);

                // If we collapsed on mobile, ensure the overlay (mobile-open) is closed.
                if (isMobileView()) {
                    sidebar.classList.remove("mobile-open");
                    backdrop.classList.remove("visible");
                    backdrop.hidden = true;
                    document.body.style.overflow = "";
                    sidebar.setAttribute("aria-hidden", "" + !wasCollapsed);
                } else {
                    // desktop: update aria-hidden for accessibility
                    sidebar.setAttribute("aria-hidden", "" + wasCollapsed);
                }

                // reposition after width change
                setTimeout(positionFloatToggle, 200);
            });
        }

        // Close when clicking backdrop
        backdrop.addEventListener("click", () => {
            sidebar.classList.remove("mobile-open");
            backdrop.classList.remove("visible");
            backdrop.hidden = true;
            document.body.style.overflow = "";
            sidebar.setAttribute("aria-hidden", "true");
        });

        // Close sidebar on resize if switching to desktop or mobile; reposition floating toggle
        window.addEventListener("resize", () => {
            if (!isMobileView()) {
                // switch to desktop: ensure overlay closed
                document.body.style.overflow = "";
                sidebar.classList.remove("mobile-open");
                backdrop.classList.remove("visible");
                backdrop.hidden = true;
                // keep collapsed if user set it
                sidebar.setAttribute("aria-hidden", "" + sidebar.classList.contains("collapsed"));
            } else {
                // mobile: keep collapsed state if present (mini strip); don't force-remove it
                if (sidebar.classList.contains("mobile-open")) {
                    sidebar.setAttribute("aria-hidden", "false");
                } else {
                    sidebar.setAttribute("aria-hidden", "" + !sidebar.classList.contains("collapsed"));
                }
            }
            // reposition the floating toggle
            setTimeout(positionFloatToggle, 10);
        });

        // Accessibility: close with Escape when mobile-open
        document.addEventListener("keydown", (e) => {
            if (e.key === "Escape" && sidebar.classList.contains("mobile-open")) {
                sidebar.classList.remove("mobile-open");
                backdrop.classList.remove("visible");
                backdrop.hidden = true;
                document.body.style.overflow = "";
                sidebar.setAttribute("aria-hidden", "true");
            }
        });

        // initial position on load
        window.addEventListener("load", () => {
            setTimeout(positionFloatToggle, 10);
        });

        // also reposition once fonts/icons loaded or after layout changes
        window.addEventListener("DOMContentLoaded", () => setTimeout(positionFloatToggle, 50));
    </script>

    <script>
        /* Keep floating toggle hugging the sidebar while scrolling */
        window.addEventListener('scroll', positionFloatToggle, { passive: true });
    </script>
</body>
</html>

<script src="~/Scripts/jquery-3.7.0.min.js"></script>
<script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>