
@{
    ViewBag.Title = "Dashboard";
}

<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <!-- Bootstrap 5 CSS -->
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link href="~/Content/dashboard.css" rel="stylesheet" />

    <!-- responsive adjustments -->
    @*<link href="~/Content/Responsive_Adjustments.css" rel="stylesheet" />*@

</head>
<body>
    <div class="layout-wrapper">

        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar ebg text-white" aria-hidden="false" aria-label="Main Sidebar">

            <div class="sidebar-header d-flex align-items-center justify-content-between px-3 py-2">
                <h5 class="mb-0 sidebar-title">E-Learning</h5>
                <!-- Floating toggle is used instead of an inline menu button -->
            </div>

            <ul class="list-unstyled px-2 mt-2">

                <li class="py-2">
                    <p class="mb-0 d-flex align-items-center gap-2 text-white">
                        <i class="bi bi-speedometer2"></i>
                        @Ajax.ActionLink(
                            "Dashboard",
                            "StudentDashboard",
                            "Student",
                            new AjaxOptions
                                 {
                                HttpMethod = "GET",
                                InsertionMode = InsertionMode.Replace,
                                UpdateTargetId = "target"
                            },
                            new { @class = "text-white text-decoration-none nav-text" }
                        )
                    </p>
                </li>

                <li class="py-2">
                    <p class="mb-0 d-flex align-items-center gap-2 text-white">
                        <i class="bi bi-calendar-event"></i>
                        @Ajax.ActionLink(
                            "Schedule Classes",
                            "ScheduleClass",
                            "Teacher",
                            new AjaxOptions
                                 {
                                HttpMethod = "GET",
                                InsertionMode = InsertionMode.Replace,
                                UpdateTargetId = "target"
                            },
                            new { @class = "text-white text-decoration-none nav-text" }
                        )
                    </p>
                </li>

                <li class="py-2">
                    <p class="mb-0 d-flex align-items-center gap-2 text-white">
                        <i class="bi bi-cloud-upload"></i>
                        @Ajax.ActionLink(
                            "Upload Study Materials",
                            "NewAssignment",
                            "Teacher",
                            new AjaxOptions
                                 {
                                HttpMethod = "GET",
                                InsertionMode = InsertionMode.Replace,
                                UpdateTargetId = "target"
                            },
                            new { @class = "text-white text-decoration-none nav-text" }
                        )
                    </p>
                </li>

                <li class="py-2">
                    <p class="mb-0 d-flex align-items-center gap-2 text-white">
                        <i class="bi bi-clipboard-check"></i>
                        @Ajax.ActionLink(
                            "Student Progress",
                            "Progress",
                            "Teacher",
                            new AjaxOptions
                                 {
                                HttpMethod = "GET",
                                InsertionMode = InsertionMode.Replace,
                                UpdateTargetId = "target"
                            },
                            new { @class = "text-white text-decoration-none nav-text" }
                        )
                    </p>
                </li>

                <li class="py-2">
                    <p class="mb-0 d-flex align-items-center gap-2 text-white">
                        <i class="bi bi-pencil-square"></i>
                        @Ajax.ActionLink(
                            "Attendance",
                            "Attendance",
                            "Teacher",
                            new AjaxOptions
                                 {
                                HttpMethod = "GET",
                                InsertionMode = InsertionMode.Replace,
                                UpdateTargetId = "target"
                            },
                            new { @class = "text-white text-decoration-none nav-text" }
                        )
                    </p>
                </li>
                <li class="py-2">
                    <p class="mb-0 d-flex align-items-center gap-2 text-white">
                        <i class="bi bi-journal-check"></i>
                        @Ajax.ActionLink(
                            "Assignment Hub",
                            "Assignment",
                            "Teacher",
                            new AjaxOptions
                                 {
                                HttpMethod = "GET",
                                InsertionMode = InsertionMode.Replace,
                                UpdateTargetId = "target"
                            },
                            new { @class = "text-white text-decoration-none nav-text" }
                        )
                    </p>
                </li>
                <li class="py-2">
                    <p class="mb-0 d-flex align-items-center gap-2 text-white">
                        <i class="bi bi-pencil-square"></i>
                        @Ajax.ActionLink(
                            "Manage Exam",
                            "Badges",
                            "Teacher",
                            new AjaxOptions
                                 {
                                HttpMethod = "GET",
                                InsertionMode = InsertionMode.Replace,
                                UpdateTargetId = "target"
                            },
                            new { @class = "text-white text-decoration-none nav-text" }
                        )
                    </p>
                </li>
                <li class="py-2">
                    <p class="mb-0 d-flex align-items-center gap-2 text-white">
                        <i class="bi bi-gear"></i>
                        @Ajax.ActionLink(
                            "Settings",
                            "Settings",
                            "Teacher",
                            new AjaxOptions
                                 {
                                HttpMethod = "GET",
                                InsertionMode = InsertionMode.Replace,
                                UpdateTargetId = "target"
                            },
                            new { @class = "text-white text-decoration-none nav-text" }
                        )
                    </p>
                </li>


            </ul>

            <div class=" px-1" id="margin_top">
                <hr class="text-white-25">
                <a href="#" class="nav-link px-2" data-bs-toggle="tooltip" title="Help">
                    <i class="bi bi-question-circle me-2"></i> <span class="nav-text">Help</span>
                </a>
            </div>
        </aside>

        <!-- Floating Desktop/Mobile Toggle (visible on all screens) -->
        <button id="sidebarFloatToggle" class="sidebar-toggle-btn" aria-label="Toggle sidebar">
            <i id="sidebarFloatIcon" class="bi bi-chevron-double-left"></i>
        </button>

        <!-- Backdrop -->
        <div id="sidebarBackdrop" class="backdrop" hidden></div>

        <!-- Main Content -->
        <main class="content-area">
            <div class="container-fluid">
                <div id="target">
                    <div class="container-fluid p-4" style="background:#f5f7fa; min-height:100vh;">

                        <!-- Header -->
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h3 class="fw-bold">Welcome Back, Teacher 👋</h3>
                            <button class="btn btn-primary shadow-sm">
                                <i class="bi bi-plus-circle"></i> Create New Course
                            </button>
                        </div>

                        <!-- Top Section -->
                        <div class="row g-4">

                            <!-- Left Column -->
                            <div class="col-lg-8">

                                <!-- Stats Cards -->
                                <div class="row g-3">

                                    <!-- Students -->
                                    <div class="col-md-6">
                                        <div class="card border-0 shadow-sm p-4">
                                            <h6 class="text-muted">Active Students</h6>
                                            <h2 class="fw-bold mt-2">340</h2>
                                            <div class="mt-3">
                                                <span class="badge bg-success">+12 this week</span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Courses -->
                                    <div class="col-md-6">
                                        <div class="card border-0 shadow-sm p-4">
                                            <h6 class="text-muted">Total Courses</h6>
                                            <h2 class="fw-bold mt-2">12</h2>
                                            <div class="mt-3">
                                                <span class="badge bg-primary">3 new</span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Pending Reviews -->
                                    <div class="col-md-6">
                                        <div class="card border-0 shadow-sm p-4">
                                            <h6 class="text-muted">Assignments to Review</h6>
                                            <h2 class="fw-bold mt-2">28</h2>
                                            <div class="mt-3">
                                                <span class="badge bg-warning">5 urgent</span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Live Classes -->
                                    <div class="col-md-6">
                                        <div class="card border-0 shadow-sm p-4">
                                            <h6 class="text-muted">Upcoming Live Classes</h6>
                                            <h2 class="fw-bold mt-2">5</h2>
                                            <div class="mt-3">
                                                <span class="badge bg-danger">2 today</span>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                                <!-- Chart -->
                                <div class="card border-0 shadow-sm p-4 mt-4">
                                    <h5 class="fw-bold mb-3">Weekly Engagement Chart</h5>
                                    <div class="w-100 text-center text-muted" style="height:260px; border:2px dashed #ccc;">
                                        Chart Placeholder
                                    </div>
                                </div>

                            </div>

                            <!-- Right Column -->
                            <div class="col-lg-4">

                                <!-- Quick Activity -->
                                <div class="card border-0 shadow-sm p-4 mb-4">
                                    <h5 class="fw-bold mb-3">Recent Activity</h5>

                                    <div class="d-flex mb-3">
                                        <i class="bi bi-check2-circle text-success fs-5 me-3"></i>
                                        <div>
                                            <strong>Reviewed assignment</strong>
                                            <p class="mb-0 small text-muted">Rohan — Java Basics</p>
                                        </div>
                                    </div>

                                    <div class="d-flex mb-3">
                                        <i class="bi bi-upload text-primary fs-5 me-3"></i>
                                        <div>
                                            <strong>Uploaded new lecture</strong>
                                            <p class="mb-0 small text-muted">Python Advanced</p>
                                        </div>
                                    </div>

                                    <div class="d-flex mb-3">
                                        <i class="bi bi-chat-dots text-warning fs-5 me-3"></i>
                                        <div>
                                            <strong>Answered a question</strong>
                                            <p class="mb-0 small text-muted">Data Structures</p>
                                        </div>
                                    </div>

                                </div>

                                <!-- Upcoming Classes -->
                                <div class="card border-0 shadow-sm p-4">
                                    <h5 class="fw-bold mb-3">Upcoming Classes</h5>

                                    <ul class="list-group list-group-flush">

                                        <li class="list-group-item px-0 d-flex justify-content-between align-items-center">
                                            <div>
                                                <strong>Frontend Basics</strong><br>
                                                <small class="text-muted">Tomorrow · 10:00 AM</small>
                                            </div>
                                            <span class="badge bg-dark">Live</span>
                                        </li>

                                        <li class="list-group-item px-0 d-flex justify-content-between align-items-center">
                                            <div>
                                                <strong>Advanced SQL</strong><br>
                                                <small class="text-muted">21 Nov · 2:00 PM</small>
                                            </div>
                                            <span class="badge bg-primary">Lecture</span>
                                        </li>

                                        <li class="list-group-item px-0 d-flex justify-content-between align-items-center">
                                            <div>
                                                <strong>React JS</strong><br>
                                                <small class="text-muted">22 Nov · 11:30 AM</small>
                                            </div>
                                            <span class="badge bg-success">Workshop</span>
                                        </li>

                                    </ul>

                                </div>

                            </div>

                        </div>

                        <!-- Bottom Section -->
                        <div class="card border-0 shadow-sm p-4 mt-4">
                            <h5 class="fw-bold mb-3">Latest Assignment Submissions</h5>

                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Student</th>
                                        <th>Course</th>
                                        <th>Submitted</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>

                                <tbody>
                                    <tr>
                                        <td>Rohan Kumar</td>
                                        <td>Java Basics</td>
                                        <td>Today</td>
                                        <td><span class="badge bg-warning">Pending</span></td>
                                    </tr>

                                    <tr>
                                        <td>Anjali Verma</td>
                                        <td>Python</td>
                                        <td>Yesterday</td>
                                        <td><span class="badge bg-success">Reviewed</span></td>
                                    </tr>

                                    <tr>
                                        <td>Aditya Singh</td>
                                        <td>Data Structures</td>
                                        <td>Today</td>
                                        <td><span class="badge bg-warning">Pending</span></td>
                                    </tr>

                                </tbody>
                            </table>

                        </div>

                    </div>

                </div>
            </div>
        </main>

    </div>

    <script>
        // Sidebar controls: desktop and mobile (menu button removed)
        const sidebar = document.getElementById("sidebar");
        const floatToggle = document.getElementById("sidebarFloatToggle");
        const floatIcon = document.getElementById("sidebarFloatIcon");
        const backdrop = document.getElementById("sidebarBackdrop");

        function isMobileView() {
            return window.innerWidth < 992;
        }

        // Position the floating toggle so it hugs the sidebar edge
        function positionFloatToggle() {
            if (!floatToggle) return;
            const rect = sidebar.getBoundingClientRect();
            const headerHeight = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--header-height')) || 65;
            const top = rect.top + headerHeight / 2;
            // place button near the right edge of the sidebar (works both for full and collapsed widths)
            const left = rect.left + rect.width - (floatToggle.offsetWidth / 2);
            floatToggle.style.top = Math.max(8, top) + 'px';
            floatToggle.style.left = Math.max(8, left) + 'px';
        }

        // Desktop & mobile mini toggle handler
        if (floatToggle) {
            floatToggle.addEventListener("click", () => {
                const wasCollapsed = sidebar.classList.toggle("collapsed");
                floatToggle.classList.toggle("collapsed", wasCollapsed);

                // If we collapsed on mobile, ensure the overlay (mobile-open) is closed.
                if (isMobileView()) {
                    sidebar.classList.remove("mobile-open");
                    backdrop.classList.remove("visible");
                    backdrop.hidden = true;
                    document.body.style.overflow = "";
                    sidebar.setAttribute("aria-hidden", "" + !wasCollapsed);
                } else {
                    // desktop: update aria-hidden for accessibility
                    sidebar.setAttribute("aria-hidden", "" + wasCollapsed);
                }

                // reposition after width change
                setTimeout(positionFloatToggle, 200);
            });
        }

        // Close when clicking backdrop
        backdrop.addEventListener("click", () => {
            sidebar.classList.remove("mobile-open");
            backdrop.classList.remove("visible");
            backdrop.hidden = true;
            document.body.style.overflow = "";
            sidebar.setAttribute("aria-hidden", "true");
        });

        // Close sidebar on resize if switching to desktop or mobile; reposition floating toggle
        window.addEventListener("resize", () => {
            if (!isMobileView()) {
                // switch to desktop: ensure overlay closed
                document.body.style.overflow = "";
                sidebar.classList.remove("mobile-open");
                backdrop.classList.remove("visible");
                backdrop.hidden = true;
                // keep collapsed if user set it
                sidebar.setAttribute("aria-hidden", "" + sidebar.classList.contains("collapsed"));
            } else {
                // mobile: keep collapsed state if present (mini strip); don't force-remove it
                if (sidebar.classList.contains("mobile-open")) {
                    sidebar.setAttribute("aria-hidden", "false");
                } else {
                    sidebar.setAttribute("aria-hidden", "" + !sidebar.classList.contains("collapsed"));
                }
            }
            // reposition the floating toggle
            setTimeout(positionFloatToggle, 10);
        });

        // Accessibility: close with Escape when mobile-open
        document.addEventListener("keydown", (e) => {
            if (e.key === "Escape" && sidebar.classList.contains("mobile-open")) {
                sidebar.classList.remove("mobile-open");
                backdrop.classList.remove("visible");
                backdrop.hidden = true;
                document.body.style.overflow = "";
                sidebar.setAttribute("aria-hidden", "true");
            }
        });

        // initial position on load
        window.addEventListener("load", () => {
            setTimeout(positionFloatToggle, 10);
        });

        // also reposition once fonts/icons loaded or after layout changes
        window.addEventListener("DOMContentLoaded", () => setTimeout(positionFloatToggle, 50));
    </script>

    <script>
        /* Keep floating toggle hugging the sidebar while scrolling */
        window.addEventListener('scroll', positionFloatToggle, { passive: true });
    </script>
</body>
</html>

<script src="~/Scripts/jquery-3.7.0.min.js"></script>
<script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>